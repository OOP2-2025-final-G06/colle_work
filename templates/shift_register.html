<!DOCTYPE html>
<html>
<head>
    <title>ã‚·ãƒ•ãƒˆç™»éŒ² - Colle-Work</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .shift-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .shift-table th, .shift-table td { border: 1px solid #ccc; padding: 10px; text-align: center; }
        .shift-table th { background-color: #eee; }
        
        input[type="time"] { padding: 5px; border-radius: 4px; border: 1px solid #ccc; }
        
        .calculated-hour { font-weight: bold; color: blue; margin-left: 10px; }
        .date-range { font-size: 0.85em; color: #666; margin-left: 10px; font-weight: normal; }

        /* æ—¥ä»˜å¤‰æ›´ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .date-control-bar {
            background-color: #f8f9fa;
            border-top: 2px solid #ddd;
            padding: 15px;
            margin-top: 30px;
            text-align: center;
        }
    </style>
</head>
<body>
    <h2>ã‚·ãƒ•ãƒˆè¡¨ç¤ºãƒ»ç™»éŒ²ç”»é¢</h2>
    
    <div style="margin-bottom: 20px;">
        <p><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼å:</strong> {{ user_name }}</p>
        <p><strong>ç¾åœ¨ã®æ—¥ä»˜è¨­å®š:</strong> <span style="font-weight: bold; color: #d63384;">{{ current_date }}</span></p>
    </div>
    <hr>

    <h3>ä»Šé€±ã®ã‚·ãƒ•ãƒˆ (é–²è¦§ã®ã¿) <span class="date-range">[{{ current_range }}]</span></h3>
    <table class="shift-table">
        <thead>
            <tr>
                <th>æ—¥ä»˜</th>
                <th>æ›œæ—¥</th>
                <th>ã‚·ãƒ•ãƒˆæ™‚é–“</th>
                <th>åˆè¨ˆæ™‚é–“</th>
            </tr>
        </thead>
        <tbody>
            {% for shift in current_week_shifts %}
            <tr>
                <td>{{ shift.shift_date }}</td>
                <td>{{ shift.weekday }}</td>
                <td>
                    {% if shift.start_time %}
                        {{ shift.start_time }} ã€œ {{ shift.end_time }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>{{ shift.shift_hour }} h</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <hr>

    <h3>æ¥é€±ã®ã‚·ãƒ•ãƒˆ (ç™»éŒ²ãƒ»å¤‰æ›´å¯èƒ½) <span class="date-range">[{{ next_range }}]</span></h3>
    <p>æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ä¿å­˜ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>

    <table class="shift-table">
        <thead>
            <tr>
                <th>æ—¥ä»˜</th>
                <th>æ›œæ—¥</th>
                <th>æ™‚é–“å…¥åŠ›</th>
                <th>ä¿å­˜ãƒ»ç¢ºèª</th>
            </tr>
        </thead>
        <tbody>
            {% for shift in next_week_shifts %}
            <tr>
                <form method="post" action="{{ url_for('shift_register', date=request.args.get('date')) }}">
                    <td>
                        {{ shift.shift_date }}
                        <input type="hidden" name="shift_date" value="{{ shift.shift_date }}">
                    </td>
                    <td>{{ shift.weekday }}</td>
                    <td>
                        <input type="time" name="start_time" value="{{ shift.start_time }}">
                        ã€œ
                        <input type="time" name="end_time" value="{{ shift.end_time }}">
                    </td>
                    <td>
                        <button type="submit">ä¿å­˜</button>
                        {% if shift.shift_hour > 0 %}
                            <span class="calculated-hour">ç™»éŒ²æ¸ˆ: {{ shift.shift_hour }} h</span>
                        {% endif %}
                    </td>
                </form>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="date-control-bar">
        <h4>ğŸ“… æ—¥ä»˜ç§»å‹•ï¼ˆå‹•ä½œç¢ºèªç”¨ï¼‰</h4>
        <form method="get" action="{{ url_for('shift_register') }}">
            <label>æŒ‡å®šã—ãŸæ—¥ä»˜ã«ã‚¸ãƒ£ãƒ³ãƒ—: </label>
            <input type="date" name="date" value="{{ current_date }}" required>
            <button type="submit">ç§»å‹•ã™ã‚‹</button>
            <a href="{{ url_for('shift_register') }}" style="margin-left: 15px; color: #666;">[ä»Šæ—¥ã«æˆ»ã‚‹]</a>
        </form>
        <p style="font-size: 0.8em; color: #888; margin-top: 5px;">â€»æ—¥ä»˜ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€ãã®æ—¥ãŒã€Œä»Šæ—¥ã€ã§ã‚ã‚‹ã‹ã®ã‚ˆã†ã«ã‚·ãƒ•ãƒˆè¡¨ãŒãšã‚Œã¾ã™ã€‚</p>
    </div>

    <br>
    <a href="{{ url_for('top') }}">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¸æˆ»ã‚‹</a>
</body>
</html>